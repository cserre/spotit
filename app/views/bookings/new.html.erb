
<div class="title-new text-center">
  <h2>Thank you for booking throught Spot it, we love you.</h2>
  <p>Please confirm your booking</p>
</div>

<div class="background-grey">
  <div class="container">
    <div class="row">
      <div class="title-new text-center">
        <h2> <%= @spot.title %></h2>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-5 col-sm-offset-1">
        <div class="margin-form">
          <p><strong>The spot you want to book : </strong></p>
          <div class="card">
            <span class="card-bg" style="background-image: url(<%= image_path @spot.photos.first.picture.url(:medium) %>)"></span>
            <span class="card-gradient"></span>
              <%= ("<i class='fa fa-star' style='color: #FFCE54;'></i>" * 4).html_safe %>
            </span> -->
            <span class="card-price">
              <%= @spot.price.to_i.to_s + ' €/day' %>
            </span>
          </div>
          <ul>
            <li> <%=@spot.description %> </li>
            <li> <%= @spot.street %> </li>
            <li> <%= @spot.post_code %> </li>
            <li> <%= @spot.city %> </li>
            <li> <%= @spot.area %> </li>
            <li> <%= @spot.style %> </li>
          </ul>
        </div>
      </div>
      <div class="col-sm-5 col-sm-offset-1">
        <div class="margin-form">
          <p id="tt_price" class="card-margin  "> <strong>Your booking is of <%= @params["total_price"] %> € </strong> </p>
          <p class="card-margin  "> The date you have chosen : </p>
          <%= simple_form_for([ @spot, @booking ]) do |f| %>
            <%= f.input :start_time, as: :string, input_html: {class: "datepicker", value: @params["start_time"]}%>
            <%= f.input :end_time, as: :string, input_html: {class: "datepicker", value: @params["end_time"] } %>
            <%= f.hidden_field :total_price, value: @params["total_price"] %>
             <%= f.hidden_field :spot_id, value: @spot.id %>
            <%= f.hidden_field :user_id, value: current_user.id %>
            <div data-toggle="modal" data-target="#myModal">
            <%= f.submit "Confirm your booking", class: "btn btn-primary"%>
            </div>
          <% end %>

        </div>
      </div>
    </div>
  </div>
</div>

      <% content_for(:after_js) do %>

      <script type="text/javascript">
        $(document).ready(function(){
        $('.datepicker').datepicker({
              startDate: 'd'
          });
        });
      </script>
      <% end %>

      <% content_for(:after_js) do %>

        <% javascript_tag do %>
          $('.simple_form').on('change', function() {

         <!--  getting all the variables from the form -->
            var start_date = new Date( $('#start_time').val());
            var end_date = new Date($('#end_time').val());

        <!--  calculating the total price for the booking-->
          var total_price = Math.round(
          <%= @spot.price %> * (((end_date-start_date) / (1000*60*60*24))+1));

        <!--  Setting the total price for the booking-->
          $("#total_price").val(total_price);

        <!--  Displaying to the view the total price for the booking-->
          $("#tt_price").text('your price would be of ' + total_price + ' €');
          })
        <% end %>
      <% end %>

      <% content_for(:after_js) do %>

        <% javascript_tag do %>
          $('.btn').on('click', function() {

        <!--  Displaying the modal-->

          })
        <% end %>
      <% end %>


<!-- Modal -->
<div class="modal" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h2 class="modal-title" id="myModalLabel">Thank you</h2>
      </div>
      <div class="modal-body">
        Thank you very much, your booking has been taken into account.
      </div>
    </div>
  </div>
</div>



